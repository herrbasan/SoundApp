<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<style>
		html, body { background-color: #323232 !important; }
		main { opacity: 0; }
		main.ready { opacity: 1; transition: opacity 0.1s ease-in; }
	</style>
	<title>MIDI Playback - SoundApp</title>
	<link media="all" rel="stylesheet" type="text/css" href="../css/fonts.css">
	<link media="all" rel="stylesheet" type="text/css" href="../libs/nui/css/nui_main.css">
	<link media="all" rel="stylesheet" type="text/css" href="../libs/nui/css/nui_select.css">
	<link media="all" rel="stylesheet" type="text/css" href="../libs/nui/css/nui_app.css">
	<link rel="stylesheet" href="../css/window.css">
	<link rel="stylesheet" href="../css/midi.css">
</head>

<body class="dark no-select" style="background-color:#323232">
	<div class="nui-app" style="background-color:#323232">
		<div class="nui-title-bar window-chrome">
			<div class="title">
				<div class="nui-icon-container">
					<i>music_note</i>
				</div>
				<div class="label">MIDI Playback</div>
			</div>
			<div class="controls">
				<div class="nui-icon-container close"><i>close</i></div>
			</div>
		</div>
		<div class="content">
			<main>
				<div class="section">
					<div class="param-group">
						<label>Global Transpose</label>
						<div class="value-display">
							<span id="pitch_value">0</span>
							<span class="unit">semitones</span>
						</div>
						<div id="pitch_slider" class="param-slider">
							<div class="track"></div>
							<div class="handle"></div>
							<div class="center-mark"></div>
						</div>
						<div class="range-labels">
							<span>-12</span>
							<span>0</span>
							<span>+12</span>
						</div>
					</div>

					<div class="param-group tempo-group">
						<label>Tempo <span id="original_bpm_display" style="font-weight:normal; opacity:0.7; font-size: 0.9em; margin-left: 8px;"></span></label>
						<div class="value-display">
							<span id="tempo_value">120</span>
							<span class="unit">BPM</span>
						</div>
						<div id="tempo_slider" class="param-slider">
							<div class="track"></div>
							<div class="handle"></div>
							<div class="center-mark"></div>
						</div>
						<div class="range-labels">
							<span>40</span>
							<span>140</span>
							<span>240</span>
						</div>
					</div>

					<div class="controls-row" style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center;">
						<div class="nui-checkbox" style="margin:0;">
							<input type="checkbox" id="btn_metronome">
							<label for="btn_metronome" style="font-size:0.9em;">Metronome</label>
						</div>

						<div id="btn_reset" style="padding: 6px 12px; font-size: 0.9em; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; cursor: pointer; transition: background 0.1s;">Reset Parameters</div>
					</div>
				</div>
				<div class="section">
					<h2>SoundFont Selection</h2>
					<div class="param-row">
						<label>Active SoundFont</label>
						<select id="soundfont-select" class="nui-select">
							<option value="TimGM6mb.sf2">TimGM6mb (6 MB) - Default</option>
							<option value="GeneralUser_GS_v1.471.sf2">GeneralUser GS (30 MB)</option>
							<option value="FluidR3_GM.sf2">FluidR3 GM (142 MB)</option>
							<option value="MuseScore_General.sf3">MuseScore General (35 MB)</option>
							<option value="Timbres_of_Heaven_GM_GS_XG_SFX_V_3.94.sf2">Timbres of Heaven (340 MB)</option>
							<option value="SGM-v2.01.sf2">SGM-V2.01 (250 MB)</option>
						</select>
					</div>
					<div class="param-row" style="margin-top:10px; justify-content: flex-end; display: flex;">
						<div id="btn_open_folder" style="padding: 6px 12px; font-size: 0.9em; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; cursor: pointer; transition: background 0.1s;">Open Soundfonts Folder</div>
					</div>
				</div>
			</main>
		</div>
		<div class="nui-status-bar"></div>
	</div>
	
	<script src="../js/window-loader.js"></script>
	<script type="module">
		import { main } from '../js/midi-settings/main.js';

		window.addEventListener('bridge-ready', async (e) => {
			const data = e.detail || {};
			await main.init(data);
			document.querySelector('main').classList.add('ready');
		});
	</script>
</body>
</html>
