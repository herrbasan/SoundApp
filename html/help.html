<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <style>
        html, body { background-color: #323232 !important; }
        main { opacity: 0; }
        main.ready { opacity: 1; transition: opacity 0.1s ease-in; }
    </style>
    <title>Help - SoundApp</title>
    <link media="all" rel="stylesheet" type="text/css" href="../css/fonts.css">
    <link media="all" rel="stylesheet" type="text/css" href="../libs/nui/css/nui_main.css">
    <link media="all" rel="stylesheet" type="text/css" href="../libs/nui/css/nui_app.css">
    <link rel="stylesheet" href="../css/window.css">
</head>

<body class="dark" style="background-color:#323232">
    <div class="nui-app" style="background-color:#323232">
        <div class="nui-title-bar">
            <div class="title">
                <div class="nui-icon-container">
                    <i>help</i>
                </div>
                <div class="label">Help</div>
            </div>
            <div class="controls">
                <div class="nui-icon-container close"><i>close</i></div>
            </div>
        </div>
        <div class="content">
            <main>
                <section class="section">
                    <h1>Keyboard Shortcuts</h1>
                    <table class="shortcuts-table" id="shortcuts-table">
                        <thead>
                            <tr>
                                <th>Key</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Populated by JS, but has static fallback for preview -->
                            <tr>
                                <td><kbd class="long">Space</kbd></td>
                                <td>Play / Pause</td>
                            </tr>
                            <tr>
                                <td><kbd>L</kbd></td>
                                <td>Toggle loop mode</td>
                            </tr>
                            <tr>
                                <td><kbd>S</kbd></td>
                                <td>Open settings</td>
                            </tr>
                            <tr>
                                <td><kbd>R</kbd></td>
								<td>Shuffle playlist instantly (drop a huge folder, then hit <kbd>R</kbd> or click the Shuffle button next to Loop)</td>
                            </tr>
                            <tr>
                                <td><kbd>←</kbd></td>
                                <td>Previous track</td>
                            </tr>
                            <tr>
                                <td><kbd>→</kbd></td>
                                <td>Next track</td>
                            </tr>
                            <tr>
                                <td><kbd class="medium">Ctrl</kbd> + <kbd>←</kbd></td>
                                <td>Skip back 10 seconds</td>
                            </tr>
                            <tr>
                                <td><kbd class="medium">Ctrl</kbd> + <kbd>→</kbd></td>
                                <td>Skip forward 10 seconds</td>
                            </tr>
                            <tr>
                                <td><kbd>↑</kbd></td>
                                <td>Volume up</td>
                            </tr>
                            <tr>
                                <td><kbd>↓</kbd></td>
                                <td>Volume down</td>
                            </tr>
                            <tr>
                                <td><kbd>P</kbd></td>
                                <td>Open Parameters window (adapts to file type)</td>
                            </tr>
                            <tr>
                                <td><kbd>I</kbd></td>
                                <td>Show file in folder</td>
                            </tr>
                            <tr>
                                <td><kbd>H</kbd></td>
                                <td>Show this help window</td>
                            </tr>
                            <tr>
                                <td><kbd>X</kbd></td>
                                <td>Toggle dark/light theme</td>
                            </tr>
                            <tr>
                                <td><kbd class="medium">Ctrl</kbd> + <kbd>+</kbd></td>
                                <td>Scale UI up</td>
                            </tr>
                            <tr>
                                <td><kbd class="medium">Ctrl</kbd> + <kbd>-</kbd></td>
                                <td>Scale UI down</td>
                            </tr>
                            <tr>
                                <td><kbd>F12</kbd></td>
                                <td>Toggle DevTools</td>
                            </tr>
                            <tr>
                                <td><kbd>Esc</kbd></td>
                                <td>Exit application</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <div class="section-divider"></div>

                <section class="section">
                    <h1>Mixer</h1>
                    <p>
                        Press <kbd>M</kbd> to open the Mixer — it grabs all the audio files sitting next to whatever you're 
                        currently playing. This is perfect for checking stems or bounces from your DAW: 
                        just drop them in a folder and hear them all together.
                    </p>
                    <table class="shortcuts-table">
                        <thead>
                            <tr>
                                <th>Key</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><kbd class="long">Space</kbd></td>
                                <td>Play / Pause</td>
                            </tr>
                            <tr>
                                <td><kbd>↑</kbd> / <kbd>↓</kbd></td>
                                <td>Master Volume</td>
                            </tr>
                            <tr>
                                <td><kbd>←</kbd> / <kbd>→</kbd></td>
                                <td>Seek (10%)</td>
                            </tr>
                            <tr>
                                <td><kbd>F1</kbd> - <kbd>F10</kbd></td>
                                <td>Solo Track 1 - 10</td>
                            </tr>
                            <tr>
                                <td><kbd>1</kbd> - <kbd>0</kbd></td>
                                <td>Solo Track 11 - 20</td>
                            </tr>
                            <tr>
                                <td><kbd class="medium">Shift</kbd> + Solo</td>
                                <td>Exclusive Solo</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <div class="section-divider"></div>

                <section class="section">
                    <h2>Drag & Drop</h2>
                    <p>
                        Just drag files or folders onto the window. SoundApp will figure out what's playable. 
                        The drop zones let you choose what happens:
                    </p>
                    <table class="shortcuts-table">
                        <tbody>
                            <tr>
                                <td><strong>Top zone</strong></td>
                                <td>Add to current playlist</td>
                            </tr>
                            <tr>
                                <td><strong>Bottom zone</strong></td>
                                <td>Replace playlist</td>
                            </tr>
                            <tr>
                                <td><strong>Multitrack Preview</strong></td>
                                <td>Open the Mixer with the dropped selection (does not replace the main playlist)</td>
                            </tr>
                        </tbody>
                    </table>
					<p>
						SoundApp is built to handle large collections — drop an entire sample library or project archive and 
                        it'll build the playlist in moments. Hold <kbd class="medium">Ctrl</kbd> if you only want the files 
                        directly in that folder, without diving into subfolders.
					</p>
                </section>

                <div class="section-divider"></div>

                <section class="section">
                    <h2>Supported Formats</h2>
                    <p>
                        Pretty much everything. MP3, WAV, FLAC, OGG, M4A, AAC, AIFF, WMA — and if FFmpeg can decode it, 
                        so can SoundApp. There's also full support for tracker modules (MOD, XM, IT, S3M and friends) 
                        if you're into that world.
                    </p>
                </section>

                <div class="section-divider"></div>

                <section class="section">
                    <h2>Loop Mode</h2>
                    <p>
                        Press <kbd>L</kbd> and the current track loops — truly gapless, no click, no hiccup. 
                        Great for locking in on a beat or letting a piece of music wash over you while you work.
                    </p>
                </section>

                <section class="section">
                    <h2>Shuffle — Finding Inspiration</h2>
					<p>
						Here's the workflow I built SoundApp around: drop a huge folder of sounds — samples, sketches, 
                        reference tracks, whatever — then hit <kbd>R</kbd> to shuffle. Arrow through them fast. 
                        No playlists to curate, no library to organize. Just you and the music, seeing what sparks.
					</p>
                </section>

                <div class="section-divider"></div>

                <section class="section">
                    <h1>Under the Hood</h1>
                    <p>
                        These settings are here if you need them, but honestly? The defaults should just work. 
                        Only dig into this if something sounds off — dropouts, stutters, that sort of thing.
                    </p>

                    <h2>Buffer Size (chunks)</h2>
                    <p>
                        Controls how much audio SoundApp buffers ahead during streaming playback.
                        This helps smooth out short read delays.
                    </p>
                    <table class="shortcuts-table">
                        <tbody>
                            <tr>
                                <td><strong>Problems it addresses</strong></td>
                                <td>Dropouts / stutter caused by slow storage or unstable I/O (e.g. network shares, slow Wi‑Fi, busy disks).</td>
                            </tr>
                            <tr>
                                <td><strong>Expected outcome</strong></td>
                                <td>More stable playback. Trade-off: slightly higher latency and memory use.</td>
                            </tr>
                            <tr>
                                <td><strong>Recommendation</strong></td>
                                <td>Leave at default. Increase only if you stream from slow/unreliable sources (e.g. Wi‑Fi + HDD).</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2>Decoder Threads (multi-threading)</h2>
                    <p>
                        Controls how many CPU threads FFmpeg uses to decode audio.
                    </p>
                    <table class="shortcuts-table">
                        <tbody>
                            <tr>
                                <td><strong>Problems it addresses</strong></td>
                                <td>CPU bottlenecks when decoding expensive formats or very high sample rates.</td>
                            </tr>
                            <tr>
                                <td><strong>Expected outcome</strong></td>
                                <td>Smoother decoding under load. Trade-off: potentially higher total CPU usage.</td>
                            </tr>
                            <tr>
                                <td><strong>Recommendation</strong></td>
                                <td>Leave on <strong>Auto</strong>. Only change it if you run into issues and want to experiment.</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2>Mixer Sync Pre-Buffer (ms)</h2>
                    <p>
                        Adds a small pre-roll in the Mixer to ensure all tracks start exactly in sync.
                    </p>
                    <table class="shortcuts-table">
                        <tbody>
                            <tr>
                                <td><strong>Problems it addresses</strong></td>
                                <td>Clicks / stutter or tracks not starting perfectly together, especially on slower systems.</td>
                            </tr>
                            <tr>
                                <td><strong>Expected outcome</strong></td>
                                <td>More reliable synchronous starts. Trade-off: slightly slower start / a bit more latency.</td>
                            </tr>
                            <tr>
                                <td><strong>Recommendation</strong></td>
                                <td>Leave at default. Increase only if you hear startup issues or sync problems.</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2>Parameters Window</h2>
                    <p>
                        Press <kbd>P</kbd> to open the Parameters window — a unified control panel that automatically adapts to the file type you're playing.
                    </p>
                    
                    <h3>Audio Files</h3>
                    <table class="shortcuts-table">
                        <tbody>
                            <tr>
                                <td><strong>Tape Speed</strong></td>
                                <td>Classic tape-style speed control (±12 semitones) where pitch and tempo change together. Active by default. Use <kbd>+</kbd>/<kbd>-</kbd> keys or the slider.</td>
                            </tr>
                            <tr>
                                <td><strong>Pitch / Time</strong></td>
                                <td>High-quality independent control via Rubber Band Library. Enable this section to shift pitch (±12 semitones) without affecting tempo, or change playback speed (50-150%) without affecting pitch. Optionally preserve formants for more natural pitch shifting.</td>
                            </tr>
                            <tr>
                                <td><strong>Lock Settings</strong></td>
                                <td>Keep parameters across track changes (disabled by default — resets to normal speed on next track).</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h3>MIDI Files</h3>
                    <table class="shortcuts-table">
                        <tbody>
                            <tr>
                                <td><strong>Global Transpose</strong></td>
                                <td>Shift all MIDI notes up or down (±12 semitones).</td>
                            </tr>
                            <tr>
                                <td><strong>Tempo</strong></td>
                                <td>Adjust playback tempo (40-240 BPM) — shows original tempo when available.</td>
                            </tr>
                            <tr>
                                <td><strong>Metronome</strong></td>
                                <td>Enable click track synced to MIDI tempo and time signature changes.</td>
                            </tr>
                            <tr>
                                <td><strong>SoundFont</strong></td>
                                <td>Choose from installed SoundFonts or open the soundfonts folder to add custom .sf2 files.</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h3>Tracker / Module Files</h3>
                    <table class="shortcuts-table">
                        <tbody>
                            <tr>
                                <td><strong>Pitch Shift</strong></td>
                                <td>Transpose tracker music (±12 semitones).</td>
                            </tr>
                            <tr>
                                <td><strong>Tempo</strong></td>
                                <td>Speed control (50-200%) for MOD/XM/IT/S3M files.</td>
                            </tr>
                            <tr>
                                <td><strong>Channel Mixer</strong></td>
                                <td>Solo or mute individual channels. Perfect for studying arrangements or isolating instruments.</td>
                            </tr>
                            <tr>
                                <td><strong>Stereo Separation</strong></td>
                                <td>Adjust stereo width (0-200%) — set to 100% for classic Amiga-style hard panning, or 0% for mono.</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2>SoundFonts (MIDI)</h2>
                    <p>
                        The application uses SoundFonts (.sf2) for MIDI playback.
                    </p>
                    
                    <h3>Bundled SoundFont</h3>
                    <p>
                        We include <strong>GeneralUser GS</strong> (configured as <code>default.sf2</code>) by default.
                    </p>
                    <ul style="list-style-type: disc; margin-left: 1.5rem; margin-bottom: 1rem;">
                        <li><strong>Author:</strong> S. Christian Collins</li>
                        <li><strong>Size:</strong> ~30 MB</li>
                        <li><strong>Description:</strong> A highly regarded GM/GS SoundFont offering an excellent balance of quality and performance.</li>
                        <li><strong>License:</strong> Permissive (allows redistribution).</li>
                    </ul>

                    <h3>Using Other SoundFonts</h3>
                    <p>
                        You can add custom SoundFonts to your library. While GeneralUser GS is excellent, larger libraries may offer more realistic samples at the cost of memory.
                    </p>
                    <p>
                        <strong>Add a new SoundFont:</strong>
                    </p>
                    <ol style="margin-left: 1.5rem; margin-bottom: 1rem;">
                        <li>Download an <code>.sf2</code> file (e.g. FluidR3_GM, Timbres of Heaven).</li>
                        <li>Place it in the application's <code>bin/soundfonts</code> folder.</li>
                        <li>Select it in the MIDI Settings (press <kbd>P</kbd> to toggle).</li>
                    </ol>
                </section>
                <section>
                    <div style="height: 4rem"></div>
                </section>
            </main>
        </div>
        <div class="nui-status-bar"></div>
    </div>

    <script src="../js/window-loader.js"></script>
    <script type="module">
        import { main } from '../js/help/main.js';

        window.addEventListener('bridge-ready', async (e) => {
            const data = e.detail || {};
            await main.init(data);
            document.querySelector('main').classList.add('ready');
        });
    </script>
</body>

</html>